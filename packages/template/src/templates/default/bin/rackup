#!/usr/bin/env -S node --disable-warning=ExperimentalWarning --watch --watch-path=./

import { initVM, createRackServer } from "@tutorialkit-rb/rails-wasm";
import path from "node:path";

const __dirname = path.dirname(new URL(import.meta.url).pathname);
const vm = await initVM({
  workspaceDir: path.join(__dirname, "../workspace"),
  pgDataDir: path.join(__dirname, "../pgdata")
});
const server = await createRackServer(vm);

server.listen(3000, () => {
  console.log("Server started on port 3000");
});